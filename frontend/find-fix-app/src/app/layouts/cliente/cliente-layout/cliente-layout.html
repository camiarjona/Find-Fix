<header class="mobile-header">
  <h3 class="sidebar-title"><a routerLink="/cliente/dashboard">FindFix</a></h3>
  <button class="hamburger-btn" (click)="toggleMobileMenu()" [class.open]="isMobileMenuOpen()">
    <span></span>
    <span></span>
    <span></span>
  </button>
</header>

<div class="sidebar-overlay" [class.open]="isMobileMenuOpen()" (click)="toggleMobileMenu()">
</div>

<div class="cliente-dashboard" [class.sidebar-collapsed]="!isSidebarOpen()"
  [class.mobile-menu-open]="isMobileMenuOpen()">

  <nav class="sidebar" [class.open]="isMobileMenuOpen()">

    <div class="sidebar-header">
      <h3 class="sidebar-title">FindFix</h3>
      <button class="hamburger-btn mobile-close" (click)="toggleMobileMenu()">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <button class="hamburger-btn desktop-toggle" (click)="toggleSidebar()">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <ul class="nav-menu">
      <li>
        <a routerLink="dashboard" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
          (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="icons.INICIO" />
              </svg>
            </span>
            <span class="nav-text">Inicio</span>
          </div>
        </a>
      </li>
      <li>
        <a routerLink="buscar-especialistas" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="icons.SEARCH" />
              </svg>
            </span>
            <span class="nav-text">Buscar Especialistas</span>
          </div>
        </a>
      </li>
      <li class="nav-separator"></li>
      <li>
        <a routerLink="mis-solicitudes" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z" />
              </svg>
            </span>
            <span class="nav-text">Mis Solicitudes</span>
          </div>
        </a>
      </li>
      <li>
        <a routerLink="mis-trabajos" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M20.25 14.15v4.25c0 1.094-.787 2.036-1.872 2.18-2.087.277-4.216.42-6.378.42s-4.291-.143-6.378-.42c-1.085-.144-1.872-1.086-1.872-2.18v-4.25m16.5 0a2.18 2.18 0 0 0 .75-1.661V8.706c0-1.081-.768-2.015-1.837-2.175a48.114 48.114 0 0 0-3.413-.387m4.5 8.006c-.194.165-.42.295-.673.38A23.978 23.978 0 0 1 12 15.75c-2.648 0-5.195-.429-7.577-1.22a2.016 2.016 0 0 1-.673-.38m0 0A2.18 2.18 0 0 1 3 12.489V8.706c0-1.081.768-2.015 1.837-2.175a48.111 48.111 0 0 1 3.413-.387m7.5 0V5.25A2.25 2.25 0 0 0 13.5 3h-3a2.25 2.25 0 0 0-2.25 2.25v.894m7.5 0a48.667 48.667 0 0 0-7.5 0M12 12.75h.008v.008H12v-.008Z" />
              </svg>
            </span>
            <span class="nav-text">Mis Trabajos</span>
          </div>
        </a>
      </li>
      <li>
        <a routerLink="mis-favoritos" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="icons.FAV" />
              </svg>
            </span>
            <span class="nav-text">Mis Favoritos</span>
          </div>
        </a>
      </li>
      <li>
        <a routerLink="mis-resenas" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="icons.RESENA" />
              </svg>
            </span>
            <span class="nav-text">Mis Reseñas</span>
          </div>
        </a>
      </li>
      <li class="nav-separator"></li>
      <li class="nav-item-dropdown" routerLinkActive="dropdown-active">
        <a href="#" (click)="toggleEspecialistaMenu($event)">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg class="sol-esp" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2"
                width="24" height="24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h8l-1-3a4 4 0 0 0-6 0l-1 3z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v2" />
                <circle cx="12" cy="13" r="2.5" stroke="currentColor" stroke-width="1.2" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M9.5 13.2h-.5m6 0h-.5" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M7 20c1-3 3-5 5-5s4 2 5 5" />
              </svg>
            </span>
            <span class="nav-text">Ser Especialista</span>
          </div>
          <span class="arrow" [class.open]="isEspecialistaMenuOpen()"></span>
        </a>
        @if (isEspecialistaMenuOpen()) {
        <ul class="submenu">
          <li>
            <a routerLink="solicitar-especialista/nueva" routerLinkActive="active-sub" (click)="handleLinkClick()">
              <span class="nav-text">Nueva Solicitud</span>
            </a>
          </li>
          <li>
            <a routerLink="solicitar-especialista/historial" routerLinkActive="active-sub" (click)="handleLinkClick()">
              <span class="nav-text">Ver Historial</span>
            </a>
          </li>
        </ul>
        }
      </li>
      <li>
        <a routerLink="mi-perfil" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
              </svg>
            </span>
            <span class="nav-text">Mi Cuenta</span>
          </div>
        </a>
      </li>
    </ul>

    <div class="sidebar-footer">
      <a (click)="logout()">
        <span class="nav-icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" />
          </svg>
        </span>
        <span class="nav-text">Cerrar Sesión</span>
      </a>
      <div class="app-version">
        <small>FindFix v1.0 © 2025</small>
      </div>
    </div>
  </nav>

  <main class="content-area">

    <header class="main-header">
      <div class="header-controls">

        <!-- Toggle de Rol (Cliente/Especialista) -->
        <label class="role-toggle" title="Cambiar a vista de {{ isEspecialistaMode() ? 'Cliente' : 'Especialista' }}">

          <!-- Conectado al signal -->
          <input type="checkbox" class="toggle-checkbox" [checked]="isEspecialistaMode()" (change)="toggleRole()">

          <span class="toggle-icons">
            <!-- Icono Cliente -->
            <span class="icon-cliente">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" [attr.d]="icons.USER" />
              </svg>
            </span>
            <!-- Icono Especialista -->
            <span class="icon-especialista">
              <svg class="sol-esp" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h8l-1-3a4 4 0 0 0-6 0l-1 3z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v2" />
                <circle cx="12" cy="13" r="2.5" stroke="currentColor" stroke-width="1.2" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M9.5 13.2h-.5m6 0h-.5" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M7 20c1-3 3-5 5-5s4 2 5 5" />
              </svg>
            </span>
          </span>
          <span class="toggle-slider"></span>
        </label>

        <!-- Separador Visual -->
        <div class="header-divider"></div>

        <!-- Botón de Tema (Sol/Luna) -->
        <button class="theme-toggle" aria-label="Cambiar tema"
          title="Cambiar a tema {{ isDarkMode() ? 'claro' : 'oscuro' }}" (click)="toggleTheme()">
          @if (isDarkMode()) {
          <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-6.248Z" />
          </svg>
          } @else {
          <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
            stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
            <!-- Círculo central -->
            <circle cx="12" cy="12" r="4.5" />

            <!-- Rayos suaves estilo minimal -->
            <path d="M12 2.5v2.5" />
            <path d="M12 19v2.5" />

            <path d="M4.5 12H2" />
            <path d="M22 12h-2.5" />

            <path d="M5.8 5.8l-1.8-1.8" />
            <path d="M20 20l-1.8-1.8" />

            <path d="M5.8 18.2l-1.8 1.8" />
            <path d="M20 4l-1.8 1.8" />
          </svg>

          }
        </button>
      </div>
    </header>

    <router-outlet></router-outlet>

  </main>
</div>
