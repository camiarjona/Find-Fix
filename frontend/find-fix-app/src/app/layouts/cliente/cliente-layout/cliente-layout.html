<header class="mobile-header">
  <h3 class="sidebar-title"><a routerLink="/cliente/dashboard">FindFix</a></h3>
  <button class="hamburger-btn" (click)="toggleMobileMenu()" [class.open]="isMobileMenuOpen()">
    <span></span>
    <span></span>
    <span></span>
  </button>
</header>

<div class="sidebar-overlay" [class.open]="isMobileMenuOpen()" (click)="toggleMobileMenu()">
</div>

<div class="cliente-dashboard" [class.sidebar-collapsed]="!isSidebarOpen()"
  [class.mobile-menu-open]="isMobileMenuOpen()">

  <nav class="sidebar" [class.open]="isMobileMenuOpen()">

    <div class="sidebar-header">
      <h3 class="sidebar-title">FindFix</h3>
      <button class="hamburger-btn mobile-close" (click)="toggleMobileMenu()">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <button class="hamburger-btn desktop-toggle" (click)="toggleSidebar()">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <ul class="nav-menu">
      <li>
        <a routerLink="dashboard" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
          (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
              </svg>
            </span>
            <span class="nav-text">Inicio</span>
          </div>
        </a>
      </li>
      <li>
        <a routerLink="buscar-especialistas" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
              </svg>
            </span>
            <span class="nav-text">Buscar Especialistas</span>
          </div>
        </a>
      </li>
      <li class="nav-separator"></li>
      <li>
        <a routerLink="mis-solicitudes" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
              </svg>
            </span>
            <span class="nav-text">Mis Solicitudes</span>
          </div>
        </a>
      </li>
      <li>
        <a routerLink="mis-trabajos" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M20.25 7.5l-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
              </svg>
            </span>
            <span class="nav-text">Mis Trabajos</span>
          </div>
        </a>
      </li>
      <li>
        <a routerLink="mis-favoritos" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" />
              </svg>
            </span>
            <span class="nav-text">Mis Favoritos</span>
          </div>
        </a>
      </li>
      <li>
        <a routerLink="mis-resenas" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.31h5.4c.566 0 .81.758.36 1.11l-4.37 3.1a.563.563 0 0 0-.215.66l1.625 5.02a.563.563 0 0 1-.84.62l-4.42-3.15a.563.563 0 0 0-.65 0l-4.42 3.15a.563.563 0 0 1-.84-.62l1.625-5.02a.563.563 0 0 0-.215-.66l-4.37-3.1a.563.563 0 0 1 .36-1.11h5.4a.563.563 0 0 0 .475-.31L11.48 3.5Z" />
              </svg>
            </span>
            <span class="nav-text">Mis Reseñas</span>
          </div>
        </a>
      </li>
      <li class="nav-separator"></li>
      <li class="nav-item-dropdown" routerLinkActive="dropdown-active">
        <a href="#" (click)="toggleEspecialistaMenu($event)">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg class="sol-esp" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h8l-1-3a4 4 0 0 0-6 0l-1 3z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v2" />
                <circle cx="12" cy="13" r="2.5" stroke="currentColor" stroke-width="1.2" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M9.5 13.2h-.5m6 0h-.5" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M7 20c1-3 3-5 5-5s4 2 5 5" />
              </svg>
            </span>
            <span class="nav-text">Ser Especialista</span>
          </div>
          <span class="arrow" [class.open]="isEspecialistaMenuOpen()"></span>
        </a>
        @if (isEspecialistaMenuOpen()) {
        <ul class="submenu">
          <li>
            <a routerLink="solicitar-especialista/nueva" routerLinkActive="active-sub" (click)="handleLinkClick()">
              <span class="nav-text">Nueva Solicitud</span>
            </a>
          </li>
          <li>
            <a routerLink="solicitar-especialista/historial" routerLinkActive="active-sub" (click)="handleLinkClick()">
              <span class="nav-text">Ver Historial</span>
            </a>
          </li>
        </ul>
        }
      </li>
      <li>
        <a routerLink="mi-perfil" routerLinkActive="active" (click)="handleLinkClick()">
          <div class="nav-link-content">
            <span class="nav-icon">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A1.875 1.875 0 0 1 18 22.5H6a1.875 1.875 0 0 1-1.499-2.382Z" />
              </svg>
            </span>
            <span class="nav-text">Mi Cuenta</span>
          </div>
        </a>
      </li>
    </ul>

    <div class="sidebar-footer">
      <a (click)="logout()">
        <span class="nav-icon">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M15.75 9l-2.25-2.25M15.75 9l2.25-2.25M15.75 9 18 6.75M15.75 9 18 11.25m.75-4.5h.008v.008H18.75V6.75Zm.008 0h.008v.008H18.75V6.75Zm.008 0h.008v.008H18.75V6.75Zm.008 0h.008v.008H18.75V6.75Z" />
          </svg>
        </span>
        <span class="nav-text">Cerrar Sesión</span>
      </a>
    </div>
  </nav>

  <main class="content-area">

    <header class="main-header">
      <div class="header-controls">

        <!-- Toggle de Rol (Cliente/Especialista) -->
        <label class="role-toggle" title="Cambiar a vista de {{ isEspecialistaMode() ? 'Cliente' : 'Especialista' }}">

          <!-- Conectado al signal -->
          <input type="checkbox" class="toggle-checkbox" [checked]="isEspecialistaMode()" (change)="toggleRole()">

          <span class="toggle-icons">
            <!-- Icono Cliente -->
            <span class="icon-cliente">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A1.875 1.875 0 0 1 18 22.5H6a1.875 1.875 0 0 1-1.499-2.382Z" />
              </svg>
            </span>
            <!-- Icono Especialista -->
            <span class="icon-especialista">
              <svg class="sol-esp" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8 10h8l-1-3a4 4 0 0 0-6 0l-1 3z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v2" />
                <circle cx="12" cy="13" r="2.5" stroke="currentColor" stroke-width="1.2" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M9.5 13.2h-.5m6 0h-.5" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M7 20c1-3 3-5 5-5s4 2 5 5" />
              </svg>
            </span>
          </span>
          <span class="toggle-slider"></span>
        </label>

        <!-- Separador Visual -->
        <div class="header-divider"></div>

        <!-- Botón de Tema (Sol/Luna) -->
        <button class="theme-toggle" aria-label="Cambiar tema"
          title="Cambiar a tema {{ isDarkMode() ? 'claro' : 'oscuro' }}" (click)="toggleTheme()">
          @if (isDarkMode()) {
          <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-6.248Z" />
          </svg>
          } @else {
          <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
            stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
            <!-- Círculo central -->
            <circle cx="12" cy="12" r="4.5" />

            <!-- Rayos suaves estilo minimal -->
            <path d="M12 2.5v2.5" />
            <path d="M12 19v2.5" />

            <path d="M4.5 12H2" />
            <path d="M22 12h-2.5" />

            <path d="M5.8 5.8l-1.8-1.8" />
            <path d="M20 20l-1.8-1.8" />

            <path d="M5.8 18.2l-1.8 1.8" />
            <path d="M20 4l-1.8 1.8" />
          </svg>

          }
        </button>
      </div>
    </header>

    <router-outlet></router-outlet>

  </main>
</div>
